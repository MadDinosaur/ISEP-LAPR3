SELECT NUM,
       (CASE WHEN REFRIGERATED_FLAG = 1 THEN 'Refrigerated' ELSE 'Non-refrigerated' END) as TYPE,
       CONTAINER_POSITION_X, CONTAINER_POSITION_Y, CONTAINER_POSITION_Z,
       PAYLOAD
FROM CONTAINER INNER JOIN CONTAINER_CARGOMANIFEST ON CONTAINER.NUM = CONTAINER_CARGOMANIFEST.CONTAINER_NUM
WHERE CARGO_MANIFEST_ID IN
      (SELECT CARGO_MANIFEST_ID
      FROM CARGOMANIFEST
      WHERE SHIP_MMSI = 1
        AND CARGOMANIFEST.STORAGE_IDENTIFICATION = 1
        AND LOADING_FLAG = 0
        AND FINISHING_DATE_TIME IS NULL);